{% extends "base.html" %}

{% block title %}{{ pilot.username }} - Pilot Profile{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <!-- Pilot Profile Card -->
      <div class="card shadow-lg border-0 mb-4">
        <div class="card-header bg-gradient-primary text-white" style="background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);">
          <div class="d-flex justify-content-between align-items-center">
            <h3 class="mb-0">
              <i class="fas fa-user-astronaut mr-2"></i>
              PILOT PROFILE: {{ pilot.username|upper }}
            </h3>
            {% if pilot.is_active %}
              <span class="badge badge-success badge-pill px-3 py-2">
                <i class="fas fa-circle mr-1"></i>ACTIVE
              </span>
            {% else %}
              <span class="badge badge-danger badge-pill px-3 py-2">
                <i class="fas fa-circle mr-1"></i>INACTIVE
              </span>
            {% endif %}
          </div>
        </div>
        <div class="card-body p-4">
          <div class="row">
            <!-- Avatar Section -->
            <div class="col-md-3 text-center mb-4">
              <div class="position-relative">
                <div class="rounded-circle mx-auto shadow-lg d-flex align-items-center justify-content-center" 
                     style="width: 150px; height: 150px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border: 4px solid #007bff;">
                  <i class="fas fa-user-astronaut fa-4x text-primary"></i>
                </div>
                <div class="position-absolute" style="bottom: 10px; right: 10px;">
                  {% if pilot.is_active %}
                    <span class="badge badge-success rounded-circle p-2">
                      <i class="fas fa-check"></i>
                    </span>
                  {% else %}
                    <span class="badge badge-secondary rounded-circle p-2">
                      <i class="fas fa-pause"></i>
                    </span>
                  {% endif %}
                </div>
              </div>
            </div>
            
            <!-- Pilot Info Section -->
            <div class="col-md-9">
              <div class="row">
                <!-- License Card -->
                <div class="col-md-6 mb-3">
                  <div class="card border-left-primary h-100">
                    <div class="card-body">
                      <div class="d-flex align-items-center">
                        <div class="mr-3">
                          <i class="fas fa-id-card fa-2x text-primary"></i>
                        </div>
                        <div>
                          <h6 class="text-primary mb-1">License Number</h6>
                          <h5 class="mb-0 font-weight-bold">{{ pilot.drone_license|default:"Not assigned" }}</h5>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Skill Rating Card -->
                <div class="col-md-6 mb-3">
                  <div class="card border-left-success h-100">
                    <div class="card-body">
                      <div class="d-flex align-items-center">
                        <div class="mr-3">
                          <i class="fas fa-star fa-2x text-success"></i>
                        </div>
                        <div class="flex-grow-1">
                          <h6 class="text-success mb-1">Skill Rating</h6>
                          <h5 class="mb-1 font-weight-bold">{{ pilot.skill_rating }}/100</h5>
                          <div class="progress" style="height: 8px;">
                            <div class="progress-bar bg-success" role="progressbar" 
                                 style="width: {{ pilot.skill_rating }}%" 
                                 aria-valuenow="{{ pilot.skill_rating }}" 
                                 aria-valuemin="0" aria-valuemax="100">
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Certification Card -->
                <div class="col-md-6 mb-3">
                  <div class="card border-left-info h-100">
                    <div class="card-body">
                      <div class="d-flex align-items-center">
                        <div class="mr-3">
                          <i class="fas fa-certificate fa-2x text-info"></i>
                        </div>
                        <div>
                          <h6 class="text-info mb-1">Certification Date</h6>
                          <h5 class="mb-0 font-weight-bold">
                            {% if pilot.certification_date %}
                              {{ pilot.certification_date|date:"M d, Y" }}
                            {% else %}
                              <span class="text-muted">Not certified</span>
                            {% endif %}
                          </h5>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Stats Card -->
                <div class="col-md-6 mb-3">
                  <div class="card border-left-warning h-100">
                    <div class="card-body">
                      <div class="d-flex align-items-center">
                        <div class="mr-3">
                          <i class="fas fa-helicopter fa-2x text-warning"></i>
                        </div>
                        <div>
                          <h6 class="text-warning mb-1">Qualified Drones</h6>
                          <h5 class="mb-0 font-weight-bold">{{ pilot.drones.count }} drone{{ pilot.drones.count|pluralize }}</h5>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Qualified Drones Section -->
      <div class="card shadow-lg border-0 mb-4">
        <div class="card-header text-white" style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);">
          <div class="d-flex justify-content-between align-items-center">
            <h4 class="mb-0">
              <i class="fas fa-helicopter mr-2"></i>
              QUALIFIED DRONES
            </h4>
            <span class="badge badge-light badge-pill px-3 py-2">
              <i class="fas fa-list-ol mr-1"></i>{{ pilot.drones.count }} drone{{ pilot.drones.count|pluralize }}
            </span>
          </div>
        </div>
        <div class="card-body p-4">
          {% if pilot.drones.all %}
            <div class="row">
              {% for drone in pilot.drones.all %}
                <div class="col-lg-4 col-md-6 mb-4">
                  <div class="card h-100 shadow-sm border-0" style="transition: transform 0.2s; border-left: 4px solid #17a2b8 !important;">
                    <div class="card-body">
                      <div class="d-flex align-items-center mb-3">
                        <div class="rounded-circle bg-info text-white d-flex align-items-center justify-content-center mr-3" 
                             style="width: 50px; height: 50px;">
                          <i class="fas fa-helicopter"></i>
                        </div>
                        <div>
                          <h5 class="card-title mb-1 font-weight-bold">{{ drone.model_name }}</h5>
                          <p class="text-muted mb-0">{{ drone.manufacturer.name }}</p>
                        </div>
                      </div>
                      
                      <div class="row text-center mb-3">
                        <div class="col-6">
                          <div class="border-right">
                            <h6 class="text-success mb-0">{{ drone.max_speed }}</h6>
                            <small class="text-muted">km/h</small>
                          </div>
                        </div>
                        <div class="col-6">
                          <h6 class="text-warning mb-0">{{ drone.weight }}</h6>
                          <small class="text-muted">kg</small>
                        </div>
                      </div>
                      
                      <div class="d-flex justify-content-between">
                        <a href="{% url 'racing:drone-detail' drone.pk %}" class="btn btn-outline-primary btn-sm">
                          <i class="fas fa-eye mr-1"></i>View
                        </a>
                        {% if user.is_authenticated and user == pilot %}
                          <button class="btn btn-outline-danger btn-sm">
                            <i class="fas fa-unlink mr-1"></i>Unassign
                          </button>
                        {% endif %}
                      </div>
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <div class="text-center py-5">
              <i class="fas fa-helicopter fa-3x text-muted mb-3"></i>
              <h5 class="text-muted">No drones assigned</h5>
              <p class="text-muted">This pilot hasn't been assigned to any drones yet.</p>
              {% if user.is_authenticated and user == pilot %}
                <a href="{% url 'racing:drone-list' %}" class="btn btn-outline-info">
                  <i class="fas fa-plus mr-1"></i>Browse Available Drones
                </a>
              {% endif %}
            </div>
          {% endif %}
        </div>
      </div>

      <!-- Action Buttons -->
      {% if user.is_authenticated and user == pilot %}
        <div class="card shadow-sm border-0">
          <div class="card-body text-center">
            <h5 class="card-title text-muted mb-3">Profile Actions</h5>
            <a href="{% url 'pilots:pilot-update' pilot.pk %}" class="btn btn-warning mr-2">
              <i class="fas fa-edit mr-1"></i>Edit Profile
            </a>
            <a href="{% url 'pilots:pilot-delete' pilot.pk %}" class="btn btn-outline-danger">
              <i class="fas fa-trash mr-1"></i>Delete Profile
            </a>
          </div>
        </div>
      {% endif %}
    </div>
  </div>
</div>

<style>
.card:hover {
  transform: translateY(-2px);
}

.border-left-primary {
  border-left: 4px solid #007bff !important;
}

.border-left-success {
  border-left: 4px solid #28a745 !important;
}

.border-left-info {
  border-left: 4px solid #17a2b8 !important;
}

.border-left-warning {
  border-left: 4px solid #ffc107 !important;
}

.progress-bar {
  transition: width 0.6s ease;
}
</style>
{% endblock %}